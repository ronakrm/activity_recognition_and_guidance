# Activity Recognition and Guidance
CS 766 Computer Vision Final Project

A final report with more detail can be found in dissemination/final_report/CS766_final_report.pdf. Notes on individual function usage can be found within that respective MATLAB function definition.

Once flow features have been generated, a top-level run of gridSearcher will perform a grid search using cross validation and output individual class accuracies, as well as total accuracy for that parameter setting.

## Feature-Action-Activity Pipeline

Given a set of input videos with respective text files describing action segmentation, the following pipeline will perform feature extraction, learning, and cross validation to output classification accuracies.

### Feature Extraction
#### Optical Flow
For detailed usage, check src/featureExtraction/FLOW/README.txt
Video files and accompanying segment text files should be named #.mp4 and #.txt as described in the README above. "vids.txt" should contain a list of video numbers to be processed.

Generated FLOW features will be stored in the data/ directory, separated by action.

#### Histograms of Oriented Optical FLow (HOOF)

HOOF generation is performed by hoofgen.m. Using the features generated by the Optical Flow, hoofgen automatically creates histograms for each half second interval for each feature in all subfolders within data/. 

### Learning

#### Codebook

HOOF features used for training are clustered using kmeans, and the clusters are then used as the codebook for testing. During testing, a new sequence of clusters is generated from an input sequence of features, based on the clusters those features are closest to. 

#### Hidden Markov Models

Cluster identifications are used as the symbol set for training the hidden markov models (HMMs). The HMMs are trained on the sequences generated from the training data after kmeans, and sequences of test symbols are sent to the HMM to be queried.

#### Petri Nets

Our domain knowledge is incorporated into the learning process through Petri Nets. We encode the activity procedure into the Petri Net, and use it to dynamically weight the log probabilities output by the HMMs. 

### Cross Validation

Once features for all videos have been generated, cross validation can be performed. Accuracies for each action are calculated as an average over the entire cross validation set.

Cross validation is called with a specification of the following parameters: number of symbols, number of HMM states, and number of HMM iterations.

### Parameter Search

gridSearcher performs a parameter search over the the number of symbols and HMM states, as well as the number of bins used in the optical flow histograms. The search space can be defined here, as well as constants for the activity domain.

#### Libraries necessary for FLOW feature generation
##### OpenCV
http://opencv.org/
##### FFMPEG
https://ffmpeg.org/
